<link rel="stylesheet" href="plugins/iCheck/all.css">
<div class="content-wrapper">
    <!-- Content Header (Page header) -->
    <section class="content-header">
        <h1>
            七星彩
            <small>游戏设置</small>
        </h1>
        <ol class="breadcrumb">
            <li><a href="#"><i class="fa fa-dashboard"></i> 仪表盘</a></li>
            <li><a href="#"> 游戏设置</a></li>
            <li class="active">七星彩</li>
        </ol>
    </section>

    <!-- Main content -->
    <section class="content">
        <div class="box box-warning">
            <div class="box-header with-border">
                <h3 class="box-title">赔率设置</h3>

                <div class="box-tools pull-right">
                    <button type="button" onclick="commit('form1')" class="btn btn-sm btn-warning">保存</button>
                </div>
            </div>
            <div class="box-body">
                <div class="row">
                    <form id="form1"  method="post">
                        <input name="roomid" hidden="hidden" value="<? echo $_SESSION['agent_room']; ?>">

                        <div class="col-md-6">
                            <div class="input-group">
                                <span class="input-group-addon">大小单双</span>
                                <input name="dxds" type="number" class="form-control" step="0.001" placeholder="输入赔率..." value="">
                            </div>
                            <br/>

                            <div class="input-group">
                                <span class="input-group-addon">任选3</span>
                                <input name="anythree" type="number" class="form-control" step="0.001" placeholder="输入赔率..." value="">
                            </div>
                            <br/>

                            <div class="input-group">
                                <span class="input-group-addon">头尾</span>
                                <input name="touweifix" type="number" class="form-control" step="0.001" placeholder="输入赔率..." value="">
                            </div>
                            <br/>

                            <div class="input-group">
                                <span class="input-group-addon">任选2</span>
                                <input name="anytwo" type="number" class="form-control" step="0.001" placeholder="输入赔率..." value="">
                            </div>
                            <br/>

                        </div>
                        <div class="col-md-6">
                            <div class="input-group">
                                <span class="input-group-addon">前4定位</span>
                                <input name="fourfix" type="number" class="form-control" step="0.001" placeholder="输入赔率..." value="">
                            </div>

                            <br/>
                            <div class="input-group">
                                <span class="input-group-addon">前3定位</span>
                                <input name="threefix" type="number" class="form-control" step="0.001" placeholder="输入赔率..." value="">
                            </div>
                            <br/>

                            <div class="input-group">
                                <span class="input-group-addon">前2定位</span>
                                <input name="twofix" type="number" class="form-control" step="0.001" placeholder="输入赔率..." value="">
                            </div>
                            <br/>

                            <div class="input-group">
                                <span class="input-group-addon">前4任选1</span>
                                <input name="onefix" type="number" class="form-control" step="0.001" placeholder="输入赔率..." value="">
                            </div>
                            <br/>

                        </div>
                    </form>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-6">
                <div class="box box-success">
                    <div class="box-header">
                        <h3 class="box-title">下注限制</h3>

                        <div class="box-tools pull-right">
                            <button type="button" onclick="commit('form28')" class="btn btn-sm btn-success">保存</button>
                            <button type="button" class="btn btn-box-tool" data-widget="remove"><i class="fa fa-times"></i></button>
                        </div>
                    </div>
                    <div class="box-body">
                        <div class="row">
                            <form id="form28" action="Application/gamesetting/ajax_savetwk3.php?form=form2" method="post">
                                <input name="roomid" hidden="hidden" value="<? echo $_SESSION['agent_room']; ?>">
                                <div class="col-md-6 col-sm-6">
                                    <div class="input-group">
                                        <span class="input-group-addon">最小下注</span>
                                        <input name="minbet" type="number" class="form-control" placeholder="输入最高下注..." value="<? echo get_query_val('fn_lottery15','dx_max',array('roomid'=>$_SESSION['agent_room'])); ?>">
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6">
                                    <div class="input-group">
                                        <span class="input-group-addon">最大下注</span>
                                        <input name="maxbet" type="number" class="form-control" placeholder="输入最高下注..." value="<? echo get_query_val('fn_lottery15','dx_max',array('roomid'=>$_SESSION['agent_room'])); ?>">
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-6">
                <div class="box box-success">
                    <div class="box-header">
                        <h3 class="box-title">其他设置</h3>

                        <div class="box-tools pull-right">
                            <? if( $_SESSION['agent_user'] =='guest1'){
echo '<p>演示盘，无权限</p>';
                            }else{?>
                            <button type="button" onclick="commit('form3')" class="btn btn-sm btn-success">保存</button>
                            <button type="button" class="btn btn-box-tool" data-widget="remove"><i class="fa fa-times"></i></button>
                            <?}?>
                        </div>
                    </div>
                    <div class="box-body">
                        <form method="post" id="form3">
                            <input name="roomid" hidden="hidden" value="<? echo $_SESSION['agent_room']; ?>">
                            <div class="form-group">
                                <label>
                                    <input name="gameopen" type="checkbox"  >
                                    开启游戏
                                </label>
                            </div>
                            <div class="input-group">
                                <span class="input-group-addon">封盘时间</span>
                                <input name="fengtime" type="number" class="form-control" placeholder="输入封盘时间..." value="">
                            </div>
                        </form>
                        <br/>
                    </div>
                </div>

                <div class="box box-success">
                    <div class="box-header with-border">
                        <h3 class="box-title">彩种规则设置</h3>

                        <div class="box-tools pull-right">
                            <? if( $_SESSION['agent_user'] =='guest1'){
echo '<p>演示盘，无权限</p>';
                            }else{?>
                            <button type="button" onclick="commit('form4')" class="btn btn-sm btn-success">保存</button>
                            <button type="button" class="btn btn-box-tool" data-widget="remove"><i class="fa fa-times"></i></button>
                            <?}?>
                        </div>
                        <!-- /.box-tools -->
                    </div>
                    <!-- /.box-header -->
                    <div class="box-body">
                        <form id="form4"  method="post">
                            <input name="roomid" hidden="hidden" value="<? echo $_SESSION['agent_room']; ?>">
                            <textarea name="rules" class="textarea" placeholder="设置彩种规则" style="width: 100%; height: 200px; font-size: 14px; line-height: 18px; border: 1px solid #dddddd; padding: 10px;">asdasd</textarea>
                        </form>
                    </div>
                    <div class="box-footer">
                        <center><b>如要使用默认样式 请直接修改要修改的文字即可</b></center>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- /.content -->
</div>

<script src="plugins/iCheck/icheck.min.js"></script>
<script>
    $('input[type="checkbox"].flat-red').iCheck({
        checkboxClass: 'icheckbox_flat-green',
        radioClass: 'iradio_flat-green'
    });


    var hrefData=parseURL(window.location.href)
    var host=hrefData.protocol+"://"+hrefData.host+":8653";

    $.ajax({
        //几个参数需要注意一下
        type: "POST",//方法类型
        dataType: "json",//预期服务器返回的数据类型
        url: host+"/qxc/LotterySetting" ,//url
        crossDomain:true,
        success: function (result) {
            console.log(result);//打印服务端返回的数据(调试用)
            if (result.code === 0) {
                $("input[name='dxds']").val(result.datas.dxds)
                $("input[name='anythree']").val(result.datas.anythree)
                $("input[name='anytwo']").val(result.datas.anytwo)
                $("input[name='fourfix']").val(result.datas.fourfix)
                $("input[name='threefix']").val(result.datas.threefix)
                $("input[name='twofix']").val(result.datas.twofix)
                $("input[name='onefix']").val(result.datas.onefix)
                $("input[name='touweifix']").val(result.datas.touweifix)
                $("input[name='minbet']").val(result.datas.minbet)
                $("input[name='maxbet']").val(result.datas.maxbet)

                $("input[name='fengtime']").val(result.datas.fengtime)
                $("textarea[name='rules']").val(result.datas.rules)
                $("input[type='checkbox'][name='gameopen']").prop({checked:result.datas.gameopen});
            }
        },
        error : function() {
            alert("服务器异常！");
        }
    });

    function parseURL(url) {
        var a = document.createElement('a');
        a.href = url;
        return {
            source: url,
            protocol: a.protocol.replace(':', ''),
            host: a.hostname,
            port: a.port,
            query: a.search,
            params: (function () {
                var ret = {},
                    seg = a.search.replace(/^\?/, '').split('&'),
                    len = seg.length, i = 0, s;
                for (; i < len; i++) {
                    if (!seg[i]) {
                        continue;
                    }
                    s = seg[i].split('=');
                    ret[s[0]] = s[1];
                }
                return ret;
            })(),
            file: (a.pathname.match(/\/([^\/?#]+)$/i) || [, ''])[1],
            hash: a.hash.replace('#', ''),
            path: a.pathname.replace(/^([^\/])/, '/$1'),
            relative: (a.href.match(/tps?:\/\/[^\/]+(.+)/) || [, ''])[1],
            segments: a.pathname.replace(/^\//, '').split('/')
        };
    }


    function commit(formId) {
        $.ajax({
            //几个参数需要注意一下
            type: "POST",//方法类型
            dataType: "json",//预期服务器返回的数据类型
            url: host+"/qxc/LotterySettingEdit" ,//url
            data: $("#"+formId).serialize(),
            crossDomain:true,
            success: function (result) {
                console.log(result);//打印服务端返回的数据(调试用)
                if (result.code === 0) {
                    alert("保存成功,10分钟后生效");
                }
            },
            error : function() {
                alert("服务器异常！");
            }
        });
    }


</script>